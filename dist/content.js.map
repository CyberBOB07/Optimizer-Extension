{"version":3,"file":"content.js","mappings":"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","sources":["webpack://tradingview-optimizer/./src/index.js"],"sourcesContent":["// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ç–æ—Ä–≥–æ–≤–ª–µ\r\nfunction getTradingInfo() {\r\n    try {\r\n        // –°–µ–ª–µ–∫—Ç–æ—Ä –¥–ª—è —Å–∏–º–≤–æ–ª–∞: –∫–Ω–æ–ø–∫–∞ —Å —Ç–µ–∫—É—â–∏–º —Å–∏–º–≤–æ–ª–æ–º –≤ –≤–µ—Ä—Ö–Ω–µ–º —Ç—É–ª–±–∞—Ä–µ\r\n        const symbolElement = document.querySelector('[data-name=\"legend-series-item\"] [data-name=\"legend-source-title\"]');\r\n        \r\n        // –°–µ–ª–µ–∫—Ç–æ—Ä –¥–ª—è –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞: –∫–Ω–æ–ø–∫–∞ —Å —Ç–µ–∫—É—â–∏–º –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º\r\n        const intervalElement = document.querySelector('button.title-l31H9iuA.accessible-l31H9iuA[aria-label=\"Change interval\"]');\r\n        \r\n        return {\r\n            symbol: symbolElement ? symbolElement.textContent.trim() : '–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω',\r\n            interval: intervalElement ? intervalElement.textContent.trim() : '–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω'\r\n        };\r\n    } catch (error) {\r\n        console.error('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö:', error);\r\n        return {\r\n            symbol: '–û—à–∏–±–∫–∞',\r\n            interval: '–û—à–∏–±–∫–∞'\r\n        };\r\n    }\r\n}\r\n\r\n// –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ\r\nlet infoWindow = null;\r\nlet isStrategySettingsDetected = false;\r\nlet isTrackingMode = false;\r\nlet strategySettingsSelector = '';\r\nlet strategyButtonIndex = -1;\r\nlet updateInterval = null;\r\n\r\n// –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –¥–ª—è —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤\r\nconst DEFAULT_SETTINGS_BUTTON_SELECTOR = '#bottom-area .backtesting .strategyGroup-zf0MHBzY .fixedContent-zf0MHBzY button.lightButton-bYDQcOkp.ghost-PVWoXu5j.gray-PVWoXu5j';\r\n\r\n// –§—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ –æ–∫–Ω–∞\r\nfunction createInfoWindow() {\r\n    const infoWindow = document.createElement('div');\r\n    infoWindow.id = 'tv-optimizer-info';\r\n    \r\n    // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–∏–ª–∏\r\n    const style = document.createElement('style');\r\n    style.textContent = `\r\n        #tv-optimizer-info {\r\n            position: fixed;\r\n            top: 50px;\r\n            right: 200px;\r\n            background: #131722;\r\n            color: #d1d4dc;\r\n            padding: 10px;\r\n            border-radius: 4px;\r\n            z-index: 9999;\r\n            font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, sans-serif;\r\n            user-select: none;\r\n            cursor: move;\r\n            border: 1px solid #363c4e;\r\n            min-width: 200px;\r\n        }\r\n        .tv-optimizer-button {\r\n            margin-top: 8px;\r\n            padding: 6px 10px;\r\n            background: #2962ff;\r\n            border: none;\r\n            border-radius: 4px;\r\n            color: white;\r\n            cursor: pointer;\r\n            width: 100%;\r\n            font-size: 11px;\r\n            transition: background 0.2s;\r\n        }\r\n        .tv-optimizer-button:hover {\r\n            background: #1e4bd8;\r\n        }\r\n    `;\r\n    document.head.appendChild(style);\r\n    \r\n    // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –æ–∫–Ω–∞\r\n    updateInfoWindow(infoWindow);\r\n    \r\n    // –î–æ–±–∞–≤–ª—è–µ–º –æ–∫–Ω–æ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É\r\n    document.body.appendChild(infoWindow);\r\n    \r\n    // –î–µ–ª–∞–µ–º –æ–∫–Ω–æ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–µ–º—ã–º\r\n    makeWindowDraggable(infoWindow);\r\n    \r\n    // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–æ–∑–∏—Ü–∏—é –∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ\r\n    chrome.storage.local.get(['windowPosition', 'strategySettingsDetected', 'strategySettingsSelector', 'strategyButtonIndex'], (result) => {\r\n        if (result.windowPosition) {\r\n            infoWindow.style.top = result.windowPosition.top;\r\n            infoWindow.style.right = result.windowPosition.right;\r\n        }\r\n        if (result.strategySettingsDetected) {\r\n            isStrategySettingsDetected = true;\r\n            strategySettingsSelector = result.strategySettingsSelector;\r\n            strategyButtonIndex = result.strategyButtonIndex;\r\n            updateInfoWindow(infoWindow);\r\n        }\r\n    });\r\n    \r\n    // –ó–∞–ø—É—Å–∫–∞–µ–º –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ\r\n    if (updateInterval) {\r\n        clearInterval(updateInterval);\r\n    }\r\n    updateInterval = setInterval(() => {\r\n        console.log('Auto-updating info window');\r\n        updateInfoWindow(infoWindow);\r\n    }, 2000);\r\n    \r\n    return infoWindow;\r\n}\r\n\r\n// –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –æ–∫–Ω–∞\r\nfunction updateInfoWindow(window = infoWindow) {\r\n    console.log('updateInfoWindow called', {\r\n        window: window,\r\n        isStrategySettingsDetected: isStrategySettingsDetected,\r\n        isTrackingMode: isTrackingMode,\r\n        strategySettingsSelector: strategySettingsSelector,\r\n        strategyButtonIndex: strategyButtonIndex\r\n    });\r\n    \r\n    if (!window) {\r\n        console.log('No window to update');\r\n        return;\r\n    }\r\n    \r\n    const info = getTradingInfo();\r\n    window.innerHTML = `\r\n        <div class=\"content\">\r\n            <div style=\"margin-bottom: 4px;\">TradingView Optimizer</div>\r\n            <div style=\"font-size: 11px; opacity: 0.8;\">\r\n                <div>–°–∏–º–≤–æ–ª: ${info.symbol}</div>\r\n                <div>–ò–Ω—Ç–µ—Ä–≤–∞–ª: ${info.interval}</div>\r\n                <div>Settings: ${isStrategySettingsDetected ? '‚úÖ' : '‚ùå'}</div>\r\n                <div>Tracking: ${isTrackingMode ? 'üîç' : '‚è∏Ô∏è'}</div>\r\n            </div>\r\n            ${!isStrategySettingsDetected ? `\r\n                <button class=\"tv-optimizer-button\" id=\"trackButton\">\r\n                    ${isTrackingMode ? '–û—Ç–º–µ–Ω–∞ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è' : '–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–Ω–æ–ø–∫—É –Ω–∞—Å—Ç—Ä–æ–µ–∫'}\r\n                </button>\r\n            ` : `\r\n                <div style=\"display: flex; gap: 4px; align-items: center;\">\r\n                    <button class=\"tv-optimizer-button\" id=\"openSettingsButton\">\r\n                        –û—Ç–∫—Ä—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏\r\n                    </button>\r\n                    <button class=\"tv-optimizer-button\" id=\"resetButton\" style=\"padding: 4px 8px; min-width: auto;\" title=\"–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–Ω–æ–ø–∫—É –∑–∞–Ω–æ–≤–æ\">\r\n                        üîÑ\r\n                    </button>\r\n                </div>\r\n            `}\r\n        </div>\r\n    `;\r\n    \r\n    console.log('Window HTML updated');\r\n    \r\n    // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫\r\n    if (!isStrategySettingsDetected) {\r\n        const trackButton = window.querySelector('#trackButton');\r\n        if (trackButton) {\r\n            console.log('Adding track button handler');\r\n            trackButton.addEventListener('click', () => {\r\n                toggleTrackingMode(!isTrackingMode);\r\n            });\r\n        }\r\n    } else {\r\n        const openSettingsButton = window.querySelector('#openSettingsButton');\r\n        if (openSettingsButton) {\r\n            console.log('Adding settings button handler');\r\n            openSettingsButton.addEventListener('click', openStrategySettings);\r\n        }\r\n        \r\n        // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ —Å–±—Ä–æ—Å–∞\r\n        const resetButton = window.querySelector('#resetButton');\r\n        if (resetButton) {\r\n            console.log('Adding reset button handler');\r\n            resetButton.addEventListener('click', resetSettings);\r\n        }\r\n    }\r\n    \r\n    console.log('Window update complete');\r\n}\r\n\r\n// –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –±—ç–∫—Ç–µ—Å—Ç–∞\r\nlet backtestResults = {\r\n    netProfit: null,\r\n    totalTrades: null,\r\n    percentProfitable: null,\r\n    profitFactor: null,\r\n    maxDrawdown: null,\r\n    netProfitPercent: null,\r\n    maxDrawdownPercent: null\r\n};\r\n\r\n// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –±—ç–∫—Ç–µ—Å—Ç–∞\r\nfunction parseBacktestResults() {\r\n    try {\r\n        const cells = document.querySelectorAll('.containerCell-Yvm0jjs7');\r\n        if (!cells || cells.length === 0) {\r\n            console.log('–Ø—á–µ–π–∫–∏ —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã');\r\n            return null;\r\n        }\r\n\r\n        cells.forEach(cell => {\r\n            const titleElement = cell.querySelector('.title-Yvm0jjs7');\r\n            const secondRow = cell.querySelector('.secondRow-Yvm0jjs7');\r\n            \r\n            if (!titleElement || !secondRow) return;\r\n            \r\n            const title = titleElement.textContent.trim();\r\n            \r\n            switch (title) {\r\n                case 'Net Profit': {\r\n                    const value = secondRow.querySelector('.positiveValue-Yvm0jjs7')?.textContent?.trim();\r\n                    const percent = secondRow.querySelector('.additionalPercent-Yvm0jjs7')?.textContent?.trim();\r\n                    backtestResults.netProfit = value;\r\n                    backtestResults.netProfitPercent = percent;\r\n                    break;\r\n                }\r\n                case 'Total Closed Trades': {\r\n                    const value = secondRow.querySelector('div:first-child')?.textContent?.trim();\r\n                    backtestResults.totalTrades = value;\r\n                    break;\r\n                }\r\n                case 'Percent Profitable': {\r\n                    const value = secondRow.querySelector('.positiveValue-Yvm0jjs7')?.textContent?.trim();\r\n                    backtestResults.percentProfitable = value;\r\n                    break;\r\n                }\r\n                case 'Profit Factor': {\r\n                    const value = secondRow.querySelector('.positiveValue-Yvm0jjs7')?.textContent?.trim();\r\n                    backtestResults.profitFactor = value;\r\n                    break;\r\n                }\r\n                case 'Max Drawdown': {\r\n                    const value = secondRow.querySelector('.negativeValue-Yvm0jjs7')?.textContent?.trim();\r\n                    const percent = secondRow.querySelector('.additionalPercent-Yvm0jjs7')?.textContent?.trim();\r\n                    backtestResults.maxDrawdown = value;\r\n                    backtestResults.maxDrawdownPercent = percent;\r\n                    break;\r\n                }\r\n            }\r\n        });\r\n\r\n        console.log('–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–∞—Ä—Å–∏–Ω–≥–∞:', backtestResults);\r\n        return backtestResults;\r\n    } catch (error) {\r\n        console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:', error);\r\n        return null;\r\n    }\r\n}\r\n\r\n// –û–±–Ω–æ–≤–ª—è–µ–º —Ñ—É–Ω–∫—Ü–∏—é updateInfoWindow, –¥–æ–±–∞–≤–ª—è—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –±—ç–∫—Ç–µ—Å—Ç–∞\r\nconst originalUpdateInfoWindow = updateInfoWindow;\r\nupdateInfoWindow = function(window = infoWindow) {\r\n    // –°–Ω–∞—á–∞–ª–∞ –≤—ã–∑—ã–≤–∞–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é\r\n    originalUpdateInfoWindow(window);\r\n    \r\n    // –ï—Å–ª–∏ –æ–∫–Ω–æ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –¥–æ–±–∞–≤–ª—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –±—ç–∫—Ç–µ—Å—Ç–∞\r\n    if (window) {\r\n        const content = window.querySelector('.content');\r\n        if (content) {\r\n            // –ü–∞—Ä—Å–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã\r\n            parseBacktestResults();\r\n            \r\n            // –î–æ–±–∞–≤–ª—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã, –µ—Å–ª–∏ –æ–Ω–∏ –µ—Å—Ç—å\r\n            if (backtestResults.netProfit) {\r\n                const backtestDiv = document.createElement('div');\r\n                backtestDiv.style.fontSize = '11px';\r\n                backtestDiv.style.opacity = '0.8';\r\n                backtestDiv.style.marginTop = '8px';\r\n                backtestDiv.style.borderTop = '1px solid #363c4e';\r\n                backtestDiv.style.paddingTop = '8px';\r\n                \r\n                const isPositive = !backtestResults.netProfit.includes('-');\r\n                const profitColor = isPositive ? '#089981' : '#f23645';\r\n                \r\n                backtestDiv.innerHTML = `\r\n                    <div style=\"margin-bottom: 4px; font-weight: bold;\">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –±—ç–∫—Ç–µ—Å—Ç–∞:</div>\r\n                    <div style=\"color: ${profitColor}\">–ü—Ä–∏–±—ã–ª—å: ${backtestResults.netProfit} (${backtestResults.netProfitPercent})</div>\r\n                    <div>–°–¥–µ–ª–æ–∫: ${backtestResults.totalTrades}</div>\r\n                    <div>–ü—Ä–∏–±—ã–ª—å–Ω—ã—Ö: ${backtestResults.percentProfitable}</div>\r\n                    <div>–ü/–§: ${backtestResults.profitFactor}</div>\r\n                    <div style=\"color: #f23645\">–ü—Ä–æ—Å–∞–¥–∫–∞: ${backtestResults.maxDrawdown} (${backtestResults.maxDrawdownPercent})</div>\r\n                `;\r\n                \r\n                content.appendChild(backtestDiv);\r\n            }\r\n        }\r\n    }\r\n};\r\n\r\n// –§—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –∫–Ω–æ–ø–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫\r\nfunction checkDefaultSettingsButton() {\r\n    console.log('Checking default settings button');\r\n    const defaultButton = document.querySelector(DEFAULT_SETTINGS_BUTTON_SELECTOR);\r\n    console.log('Default button found:', defaultButton);\r\n    \r\n    if (defaultButton) {\r\n        // –°–æ—Ö—Ä–∞–Ω—è–µ–º —ç—Ç—É –∫–Ω–æ–ø–∫—É –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω—É—é\r\n        strategySettingsSelector = DEFAULT_SETTINGS_BUTTON_SELECTOR;\r\n        strategyButtonIndex = 0; // –≠—Ç–∞ –∫–Ω–æ–ø–∫–∞ –≤—Å–µ–≥–¥–∞ –æ–¥–Ω–∞\r\n        isStrategySettingsDetected = true;\r\n        \r\n        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ storage\r\n        chrome.storage.local.set({\r\n            strategySettingsDetected: true,\r\n            strategySettingsSelector: strategySettingsSelector,\r\n            strategyButtonIndex: strategyButtonIndex\r\n        }, () => {\r\n            console.log('Default settings button saved');\r\n            updateInfoWindow();\r\n        });\r\n        \r\n        return true;\r\n    }\r\n    \r\n    return false;\r\n}\r\n\r\n// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏\r\nfunction openStrategySettings() {\r\n    console.log('Trying to open strategy settings');\r\n    \r\n    // –ü—Ä–æ–±—É–µ–º –Ω–∞–π—Ç–∏ –∫–Ω–æ–ø–∫—É –ø–æ –æ—Å–Ω–æ–≤–Ω–æ–º—É —Å–µ–ª–µ–∫—Ç–æ—Ä—É\r\n    const defaultButton = document.querySelector(DEFAULT_SETTINGS_BUTTON_SELECTOR);\r\n    console.log('Default settings button:', defaultButton);\r\n    \r\n    if (defaultButton) {\r\n        console.log('Using default settings button');\r\n        simulateClick(defaultButton);\r\n        return true;\r\n    }\r\n    \r\n    // –ï—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏, –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—É—é –∫–Ω–æ–ø–∫—É\r\n    if (strategySettingsSelector && strategySettingsSelector !== DEFAULT_SETTINGS_BUTTON_SELECTOR) {\r\n        console.log('Trying to find settings button with selector:', strategySettingsSelector, 'index:', strategyButtonIndex);\r\n        const allButtons = Array.from(document.querySelectorAll(strategySettingsSelector));\r\n        console.log('Found buttons:', allButtons.length);\r\n        \r\n        if (allButtons.length > strategyButtonIndex) {\r\n            const settingsButton = allButtons[strategyButtonIndex];\r\n            console.log('Using saved button:', settingsButton);\r\n            simulateClick(settingsButton);\r\n            return true;\r\n        }\r\n    }\r\n    \r\n    // –ï—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏ –Ω–∏ –æ–¥–Ω—É –∫–Ω–æ–ø–∫—É, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ –≤–∫–ª—é—á–∞–µ–º –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ\r\n    showNotification('–ö–Ω–æ–ø–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞. –í–∫–ª—é—á–∞—é —Ä–µ–∂–∏–º –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è üîç');\r\n    toggleTrackingMode(true);\r\n    return false;\r\n}\r\n\r\n// –§—É–Ω–∫—Ü–∏—è —Å–±—Ä–æ—Å–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫\r\nfunction resetSettings() {\r\n    console.log('Resetting settings');\r\n    isStrategySettingsDetected = false;\r\n    strategySettingsSelector = '';\r\n    strategyButtonIndex = -1;\r\n    \r\n    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ\r\n    chrome.storage.local.set({\r\n        strategySettingsDetected: false,\r\n        strategySettingsSelector: '',\r\n        strategyButtonIndex: -1\r\n    }, () => {\r\n        console.log('Settings reset');\r\n        showNotification('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–±—Ä–æ—à–µ–Ω—ã ‚ú®');\r\n        // –ü–µ—Ä–µ—Å–æ–∑–¥–∞–µ–º –æ–∫–Ω–æ\r\n        if (infoWindow) {\r\n            document.body.removeChild(infoWindow);\r\n        }\r\n        createInfoWindow();\r\n    });\r\n}\r\n\r\n// –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–∏–º—É–ª—è—Ü–∏–∏ –∫–ª–∏–∫–∞\r\nfunction simulateClick(element) {\r\n    console.log('Simulating click on element:', element);\r\n    \r\n    // –ü—Ä–æ–±—É–µ–º —Ä–∞–∑–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã –∫–ª–∏–∫–∞\r\n    try {\r\n        // 1. –°–æ–∑–¥–∞–µ–º –∏ –¥–∏—Å–ø–∞—Ç—á–∏–º —Å–æ–±—ã—Ç–∏–µ click\r\n        const clickEvent = new MouseEvent('click', {\r\n            bubbles: true,\r\n            cancelable: true,\r\n            view: window\r\n        });\r\n        element.dispatchEvent(clickEvent);\r\n        \r\n        // 2. –ï—Å–ª–∏ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–æ, –ø—Ä–æ–±—É–µ–º mousedown/mouseup\r\n        const mouseDownEvent = new MouseEvent('mousedown', {\r\n            bubbles: true,\r\n            cancelable: true,\r\n            view: window\r\n        });\r\n        const mouseUpEvent = new MouseEvent('mouseup', {\r\n            bubbles: true,\r\n            cancelable: true,\r\n            view: window\r\n        });\r\n        element.dispatchEvent(mouseDownEvent);\r\n        element.dispatchEvent(mouseUpEvent);\r\n        \r\n        // 3. –ü—Ä–æ–±—É–µ–º –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã–π –∫–ª–∏–∫\r\n        element.click();\r\n        \r\n    } catch (error) {\r\n        console.error('Error simulating click:', error);\r\n    }\r\n}\r\n\r\n// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è –æ–∫–Ω–∞\r\nfunction makeWindowDraggable(window) {\r\n    let isDragging = false;\r\n    let currentX;\r\n    let currentY;\r\n    let initialX;\r\n    let initialY;\r\n    let xOffset = 0;\r\n    let yOffset = 0;\r\n    \r\n    function dragStart(e) {\r\n        if (e.type === \"touchstart\") {\r\n            initialX = e.touches[0].clientX - xOffset;\r\n            initialY = e.touches[0].clientY - yOffset;\r\n        } else {\r\n            initialX = e.clientX - xOffset;\r\n            initialY = e.clientY - yOffset;\r\n        }\r\n        \r\n        if (e.target === window) {\r\n            isDragging = true;\r\n        }\r\n    }\r\n    \r\n    function dragEnd() {\r\n        if (!isDragging) return;\r\n        \r\n        initialX = currentX;\r\n        initialY = currentY;\r\n        isDragging = false;\r\n        \r\n        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–æ–∑–∏—Ü–∏—é\r\n        chrome.storage.local.set({\r\n            windowPosition: {\r\n                top: window.style.top,\r\n                right: window.style.right\r\n            }\r\n        });\r\n    }\r\n    \r\n    function drag(e) {\r\n        if (!isDragging) return;\r\n        \r\n        e.preventDefault();\r\n        \r\n        if (e.type === \"touchmove\") {\r\n            currentX = e.touches[0].clientX - initialX;\r\n            currentY = e.touches[0].clientY - initialY;\r\n        } else {\r\n            currentX = e.clientX - initialX;\r\n            currentY = e.clientY - initialY;\r\n        }\r\n        \r\n        xOffset = currentX;\r\n        yOffset = currentY;\r\n        window.style.transform = `translate(${currentX}px, ${currentY}px)`;\r\n    }\r\n    \r\n    window.addEventListener(\"touchstart\", dragStart, false);\r\n    window.addEventListener(\"touchend\", dragEnd, false);\r\n    window.addEventListener(\"touchmove\", drag, false);\r\n    window.addEventListener(\"mousedown\", dragStart, false);\r\n    window.addEventListener(\"mouseup\", dragEnd, false);\r\n    window.addEventListener(\"mousemove\", drag, false);\r\n}\r\n\r\n// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è/–≤—ã–∫–ª—é—á–µ–Ω–∏—è —Ä–µ–∂–∏–º–∞ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è\r\nfunction toggleTrackingMode(enable) {\r\n    console.log('toggleTrackingMode:', enable);\r\n    isTrackingMode = enable;\r\n    \r\n    if (enable) {\r\n        // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –Ω–∞ –≤—Å–µ —ç—Ç–∞–ø—ã –∫–ª–∏–∫–∞\r\n        document.addEventListener('mousedown', detectStrategySettings, true);\r\n        document.addEventListener('mouseup', detectStrategySettings, true);\r\n        document.addEventListener('click', detectStrategySettings, true);\r\n        showNotification('–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –Ω–∞—Å—Ç—Ä–æ–µ–∫ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ üéØ');\r\n    } else {\r\n        // –£–¥–∞–ª—è–µ–º –≤—Å–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏\r\n        document.removeEventListener('mousedown', detectStrategySettings, true);\r\n        document.removeEventListener('mouseup', detectStrategySettings, true);\r\n        document.removeEventListener('click', detectStrategySettings, true);\r\n        showNotification('–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –æ—Ç–º–µ–Ω–µ–Ω–æ ‚è∏Ô∏è');\r\n    }\r\n    \r\n    updateInfoWindow();\r\n}\r\n\r\n// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∫–ª–∏–∫–∞ –ø–æ –∫–Ω–æ–ø–∫–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫\r\nfunction detectStrategySettings(event) {\r\n    console.log('detectStrategySettings called, tracking mode:', isTrackingMode);\r\n    \r\n    if (!isTrackingMode) return;\r\n    \r\n    const target = event.target;\r\n    console.log('Click target:', target);\r\n    console.log('Target attributes:', {\r\n        class: target.className,\r\n        dataName: target.getAttribute('data-name'),\r\n        role: target.getAttribute('role'),\r\n        ariaLabel: target.getAttribute('aria-label'),\r\n        innerHTML: target.innerHTML\r\n    });\r\n    \r\n    // –ò—â–µ–º –∫–Ω–æ–ø–∫—É –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø–æ —Ä–∞–∑–Ω—ã–º —Å–µ–ª–µ–∫—Ç–æ—Ä–∞–º\r\n    const settingsButton = target.closest('button.lightButton-bYDQcOkp.ghost-PVWoXu5j.gray-PVWoXu5j, [data-name=\"legend-settings-action\"]');\r\n    console.log('Found settings button:', settingsButton);\r\n    \r\n    if (settingsButton) {\r\n        // –ü–æ–ª–Ω–æ—Å—Ç—å—é –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–æ–±—ã—Ç–∏–µ –Ω–∞ —ç—Ç–∞–ø–µ –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞\r\n        event.preventDefault();\r\n        event.stopPropagation();\r\n        event.stopImmediatePropagation();\r\n        event.returnValue = false;\r\n        \r\n        // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–µ–ª–µ–∫—Ç–æ—Ä\r\n        if (settingsButton.matches('button.lightButton-bYDQcOkp.ghost-PVWoXu5j.gray-PVWoXu5j')) {\r\n            strategySettingsSelector = 'button.lightButton-bYDQcOkp.ghost-PVWoXu5j.gray-PVWoXu5j';\r\n        } else {\r\n            strategySettingsSelector = '[data-name=\"legend-settings-action\"]';\r\n        }\r\n        \r\n        // –ù–∞—Ö–æ–¥–∏–º –∏–Ω–¥–µ–∫—Å –∫–Ω–æ–ø–∫–∏\r\n        const allButtons = Array.from(document.querySelectorAll(strategySettingsSelector));\r\n        const buttonIndex = allButtons.indexOf(settingsButton);\r\n        console.log('Button index:', buttonIndex, 'of', allButtons.length, 'buttons');\r\n        strategyButtonIndex = buttonIndex;\r\n        \r\n        console.log('Using selector:', strategySettingsSelector, 'with index:', strategyButtonIndex);\r\n        \r\n        // –°–Ω–∞—á–∞–ª–∞ –æ—Ç–∫–ª—é—á–∞–µ–º –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ\r\n        isTrackingMode = false;\r\n        document.removeEventListener('mousedown', detectStrategySettings, true);\r\n        document.removeEventListener('mouseup', detectStrategySettings, true);\r\n        document.removeEventListener('click', detectStrategySettings, true);\r\n        \r\n        // –ó–∞—Ç–µ–º —Å–æ—Ö—Ä–∞–Ω—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏ –æ–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ\r\n        console.log('Setting isStrategySettingsDetected to true');\r\n        isStrategySettingsDetected = true;\r\n        \r\n        // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–µ–º –æ–∫–Ω–æ\r\n        console.log('Recreating info window...');\r\n        if (infoWindow) {\r\n            document.body.removeChild(infoWindow);\r\n        }\r\n        createInfoWindow();\r\n        \r\n        // –ò —Ç–æ–ª—å–∫–æ –ø–æ—Ç–æ–º —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤ storage\r\n        chrome.storage.local.set({\r\n            strategySettingsDetected: true,\r\n            strategySettingsSelector: strategySettingsSelector,\r\n            strategyButtonIndex: strategyButtonIndex\r\n        }, () => {\r\n            console.log('Settings saved to storage');\r\n            showNotification('–ö–Ω–æ–ø–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ —É—Å–ø–µ—à–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞! ‚úÖ');\r\n        });\r\n        \r\n        return false;\r\n    }\r\n}\r\n\r\n// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫–∞–∑–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è\r\nfunction showNotification(message) {\r\n    const notification = document.createElement('div');\r\n    notification.style.cssText = `\r\n        position: fixed;\r\n        top: 20px;\r\n        left: 50%;\r\n        transform: translateX(-50%);\r\n        background: #131722;\r\n        color: #d1d4dc;\r\n        padding: 10px 20px;\r\n        border-radius: 4px;\r\n        z-index: 9999;\r\n        border: 1px solid #363c4e;\r\n        font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, sans-serif;\r\n    `;\r\n    notification.textContent = message;\r\n    document.body.appendChild(notification);\r\n    \r\n    setTimeout(() => {\r\n        notification.remove();\r\n    }, 3000);\r\n}\r\n\r\n// –§—É–Ω–∫—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ–∫–Ω–æ–º\r\nfunction showInfoWindow() {\r\n    if (!infoWindow) {\r\n        infoWindow = createInfoWindow();\r\n    }\r\n}\r\n\r\nfunction hideInfoWindow() {\r\n    if (infoWindow) {\r\n        if (updateInterval) {\r\n            clearInterval(updateInterval);\r\n            updateInterval = null;\r\n        }\r\n        infoWindow.remove();\r\n        infoWindow = null;\r\n    }\r\n}\r\n\r\n// –°–ª—É—à–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç popup\r\nchrome.runtime.onMessage.addListener((request, sender, sendResponse) => {\r\n    if (request.type === 'GET_TRADING_INFO') {\r\n        sendResponse(getTradingInfo());\r\n    } else if (request.type === 'TOGGLE_INFO_WINDOW') {\r\n        if (request.show) {\r\n            showInfoWindow();\r\n        } else {\r\n            hideInfoWindow();\r\n        }\r\n    }\r\n    return true;\r\n});\r\n\r\n// –ü—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –∫–Ω–æ–ø–∫–∏\r\ndocument.addEventListener('DOMContentLoaded', () => {\r\n    console.log('DOM loaded, checking settings button');\r\n    \r\n    // –î–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü–µ –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∏—Ç—å—Å—è –ø–æ–ª–Ω–æ—Å—Ç—å—é\r\n    setTimeout(() => {\r\n        if (!isStrategySettingsDetected) {\r\n            checkDefaultSettingsButton();\r\n        }\r\n    }, 2000);\r\n});\r\n\r\n// –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –∫–Ω–æ–ø–∫–∏\r\nsetInterval(() => {\r\n    if (!isStrategySettingsDetected) {\r\n        checkDefaultSettingsButton();\r\n    }\r\n}, 5000);\r\n\r\n// –ü—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ\r\nchrome.storage.local.get(['strategySettingsDetected', 'strategySettingsSelector', 'strategyButtonIndex'], (result) => {\r\n    console.log('Loaded storage:', result);\r\n    if (result.strategySettingsDetected) {\r\n        isStrategySettingsDetected = true;\r\n        strategySettingsSelector = result.strategySettingsSelector;\r\n        strategyButtonIndex = result.strategyButtonIndex;\r\n        console.log('Restored settings selector:', strategySettingsSelector, 'with index:', strategyButtonIndex);\r\n    }\r\n});\r\n\r\n// –°–æ–∑–¥–∞–µ–º MutationObserver –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö –±—ç–∫—Ç–µ—Å—Ç–∞\r\nconst backtestObserver = new MutationObserver(() => {\r\n    if (infoWindow) {\r\n        updateInfoWindow();\r\n    }\r\n});\r\n\r\n// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è –∑–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –±—ç–∫—Ç–µ—Å—Ç–∞\r\nfunction observeBacktestResults() {\r\n    const resultsContainer = document.querySelector('.backtesting-content');\r\n    if (resultsContainer) {\r\n        backtestObserver.observe(resultsContainer, {\r\n            childList: true,\r\n            subtree: true,\r\n            characterData: true\r\n        });\r\n    }\r\n}\r\n\r\n// –ó–∞–ø—É—Å–∫–∞–µ–º –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã\r\ndocument.addEventListener('DOMContentLoaded', () => {\r\n    setTimeout(observeBacktestResults, 2000);\r\n});\r\n\r\n// –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏\r\nsetInterval(() => {\r\n    observeBacktestResults();\r\n}, 5000);\r\n"],"names":["getTradingInfo","symbolElement","document","querySelector","intervalElement","symbol","textContent","trim","interval","error","console","infoWindow","isStrategySettingsDetected","isTrackingMode","strategySettingsSelector","strategyButtonIndex","updateInterval","DEFAULT_SETTINGS_BUTTON_SELECTOR","createInfoWindow","createElement","id","style","head","appendChild","updateInfoWindow","body","window","currentX","currentY","initialX","initialY","isDragging","xOffset","yOffset","dragStart","e","type","touches","clientX","clientY","target","dragEnd","chrome","storage","local","set","windowPosition","top","right","drag","preventDefault","transform","concat","addEventListener","makeWindowDraggable","get","result","strategySettingsDetected","clearInterval","setInterval","log","arguments","length","undefined","info","innerHTML","openSettingsButton","openStrategySettings","resetButton","resetSettings","trackButton","toggleTrackingMode","backtestResults","netProfit","totalTrades","percentProfitable","profitFactor","maxDrawdown","netProfitPercent","maxDrawdownPercent","originalUpdateInfoWindow","checkDefaultSettingsButton","defaultButton","simulateClick","allButtons","Array","from","querySelectorAll","settingsButton","showNotification","removeChild","element","clickEvent","MouseEvent","bubbles","cancelable","view","dispatchEvent","mouseDownEvent","mouseUpEvent","click","enable","detectStrategySettings","removeEventListener","event","class","className","dataName","getAttribute","role","ariaLabel","closest","stopPropagation","stopImmediatePropagation","returnValue","matches","buttonIndex","indexOf","message","notification","cssText","setTimeout","remove","content","cells","forEach","cell","titleElement","secondRow","_secondRow$querySelec","_secondRow$querySelec2","value","percent","_secondRow$querySelec3","_secondRow$querySelec4","_secondRow$querySelec5","_secondRow$querySelec6","_secondRow$querySelec7","parseBacktestResults","backtestDiv","fontSize","opacity","marginTop","borderTop","paddingTop","profitColor","includes","runtime","onMessage","addListener","request","sender","sendResponse","show","backtestObserver","MutationObserver","observeBacktestResults","resultsContainer","observe","childList","subtree","characterData"],"sourceRoot":""}