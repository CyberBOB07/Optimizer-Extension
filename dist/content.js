(()=>{function t(){try{var t=document.querySelector('[data-name="legend-series-item"] [data-name="legend-source-title"]'),e=document.querySelector('button.title-l31H9iuA.accessible-l31H9iuA[aria-label="Change interval"]');return{symbol:t?t.textContent.trim():"–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω",interval:e?e.textContent.trim():"–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω"}}catch(t){return console.error("–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö:",t),{symbol:"–û—à–∏–±–∫–∞",interval:"–û—à–∏–±–∫–∞"}}}var e=null,n=!1,o=!1,i="",r=-1,l=null,c="#bottom-area .backtesting .strategyGroup-zf0MHBzY .fixedContent-zf0MHBzY button.lightButton-bYDQcOkp.ghost-PVWoXu5j.gray-PVWoXu5j";function a(){var t=document.createElement("div");t.id="tv-optimizer-info";var e=document.createElement("style");return e.textContent='\n        #tv-optimizer-info {\n            position: fixed;\n            top: 50px;\n            right: 200px;\n            background: #131722;\n            color: #d1d4dc;\n            padding: 10px;\n            border-radius: 4px;\n            z-index: 9999;\n            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;\n            user-select: none;\n            cursor: move;\n            border: 1px solid #363c4e;\n            min-width: 200px;\n        }\n        .tv-optimizer-button {\n            margin-top: 8px;\n            padding: 6px 10px;\n            background: #2962ff;\n            border: none;\n            border-radius: 4px;\n            color: white;\n            cursor: pointer;\n            width: 100%;\n            font-size: 11px;\n            transition: background 0.2s;\n        }\n        .tv-optimizer-button:hover {\n            background: #1e4bd8;\n        }\n    ',document.head.appendChild(e),s(t),document.body.appendChild(t),function(t){var e,n,o,i,r=!1,l=0,c=0;function a(e){"touchstart"===e.type?(o=e.touches[0].clientX-l,i=e.touches[0].clientY-c):(o=e.clientX-l,i=e.clientY-c),e.target===t&&(r=!0)}function s(){r&&(o=e,i=n,r=!1,chrome.storage.local.set({windowPosition:{top:t.style.top,right:t.style.right}}))}function d(a){r&&(a.preventDefault(),"touchmove"===a.type?(e=a.touches[0].clientX-o,n=a.touches[0].clientY-i):(e=a.clientX-o,n=a.clientY-i),l=e,c=n,t.style.transform="translate(".concat(e,"px, ").concat(n,"px)"))}t.addEventListener("touchstart",a,!1),t.addEventListener("touchend",s,!1),t.addEventListener("touchmove",d,!1),t.addEventListener("mousedown",a,!1),t.addEventListener("mouseup",s,!1),t.addEventListener("mousemove",d,!1)}(t),chrome.storage.local.get(["windowPosition","strategySettingsDetected","strategySettingsSelector","strategyButtonIndex"],(function(e){e.windowPosition&&(t.style.top=e.windowPosition.top,t.style.right=e.windowPosition.right),e.strategySettingsDetected&&(n=!0,i=e.strategySettingsSelector,r=e.strategyButtonIndex,s(t))})),l&&clearInterval(l),l=setInterval((function(){console.log("Auto-updating info window"),s(t)}),2e3),t}function s(){var l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e;if(console.log("updateInfoWindow called",{window:l,isStrategySettingsDetected:n,isTrackingMode:o,strategySettingsSelector:i,strategyButtonIndex:r}),l){var c=t();if(l.innerHTML='\n        <div class="content">\n            <div style="margin-bottom: 4px;">TradingView Optimizer</div>\n            <div style="font-size: 11px; opacity: 0.8;">\n                <div>–°–∏–º–≤–æ–ª: '.concat(c.symbol,"</div>\n                <div>–ò–Ω—Ç–µ—Ä–≤–∞–ª: ").concat(c.interval,"</div>\n                <div>Settings: ").concat(n?"‚úÖ":"‚ùå","</div>\n                <div>Tracking: ").concat(o?"üîç":"‚è∏Ô∏è","</div>\n            </div>\n            ").concat(n?'\n                <div style="display: flex; gap: 4px; align-items: center;">\n                    <button class="tv-optimizer-button" id="openSettingsButton">\n                        –û—Ç–∫—Ä—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏\n                    </button>\n                    <button class="tv-optimizer-button" id="resetButton" style="padding: 4px 8px; min-width: auto;" title="–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–Ω–æ–ø–∫—É –∑–∞–Ω–æ–≤–æ">\n                        üîÑ\n                    </button>\n                </div>\n            ':'\n                <button class="tv-optimizer-button" id="trackButton">\n                    '.concat(o?"–û—Ç–º–µ–Ω–∞ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è":"–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–Ω–æ–ø–∫—É –Ω–∞—Å—Ç—Ä–æ–µ–∫","\n                </button>\n            "),"\n        </div>\n    "),console.log("Window HTML updated"),n){var a=l.querySelector("#openSettingsButton");a&&(console.log("Adding settings button handler"),a.addEventListener("click",v));var s=l.querySelector("#resetButton");s&&(console.log("Adding reset button handler"),s.addEventListener("click",m))}else{var d=l.querySelector("#trackButton");d&&(console.log("Adding track button handler"),d.addEventListener("click",(function(){f(!o)})))}console.log("Window update complete")}else console.log("No window to update")}var d={netProfit:null,totalTrades:null,percentProfitable:null,profitFactor:null,maxDrawdown:null,netProfitPercent:null,maxDrawdownPercent:null},u=s;function g(){console.log("Checking default settings button");var t=document.querySelector(c);return console.log("Default button found:",t),!!t&&(i=c,r=0,n=!0,chrome.storage.local.set({strategySettingsDetected:!0,strategySettingsSelector:i,strategyButtonIndex:r},(function(){console.log("Default settings button saved"),s()})),!0)}function v(){console.log("Trying to open strategy settings");var t=document.querySelector(c);if(console.log("Default settings button:",t),t)return console.log("Using default settings button"),p(t),!0;if(i&&i!==c){console.log("Trying to find settings button with selector:",i,"index:",r);var e=Array.from(document.querySelectorAll(i));if(console.log("Found buttons:",e.length),e.length>r){var n=e[r];return console.log("Using saved button:",n),p(n),!0}}return b("–ö–Ω–æ–ø–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞. –í–∫–ª—é—á–∞—é —Ä–µ–∂–∏–º –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è üîç"),f(!0),!1}function m(){console.log("Resetting settings"),n=!1,i="",r=-1,chrome.storage.local.set({strategySettingsDetected:!1,strategySettingsSelector:"",strategyButtonIndex:-1},(function(){console.log("Settings reset"),b("–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–±—Ä–æ—à–µ–Ω—ã ‚ú®"),e&&document.body.removeChild(e),a()}))}function p(t){console.log("Simulating click on element:",t);try{var e=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});t.dispatchEvent(e);var n=new MouseEvent("mousedown",{bubbles:!0,cancelable:!0,view:window}),o=new MouseEvent("mouseup",{bubbles:!0,cancelable:!0,view:window});t.dispatchEvent(n),t.dispatchEvent(o),t.click()}catch(t){console.error("Error simulating click:",t)}}function f(t){console.log("toggleTrackingMode:",t),o=t,t?(document.addEventListener("mousedown",y,!0),document.addEventListener("mouseup",y,!0),document.addEventListener("click",y,!0),b("–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –Ω–∞—Å—Ç—Ä–æ–µ–∫ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ üéØ")):(document.removeEventListener("mousedown",y,!0),document.removeEventListener("mouseup",y,!0),document.removeEventListener("click",y,!0),b("–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –æ—Ç–º–µ–Ω–µ–Ω–æ ‚è∏Ô∏è")),s()}function y(t){if(console.log("detectStrategySettings called, tracking mode:",o),o){var l=t.target;console.log("Click target:",l),console.log("Target attributes:",{class:l.className,dataName:l.getAttribute("data-name"),role:l.getAttribute("role"),ariaLabel:l.getAttribute("aria-label"),innerHTML:l.innerHTML});var c=l.closest('button.lightButton-bYDQcOkp.ghost-PVWoXu5j.gray-PVWoXu5j, [data-name="legend-settings-action"]');if(console.log("Found settings button:",c),c){t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),t.returnValue=!1,i=c.matches("button.lightButton-bYDQcOkp.ghost-PVWoXu5j.gray-PVWoXu5j")?"button.lightButton-bYDQcOkp.ghost-PVWoXu5j.gray-PVWoXu5j":'[data-name="legend-settings-action"]';var s=Array.from(document.querySelectorAll(i)),d=s.indexOf(c);return console.log("Button index:",d,"of",s.length,"buttons"),r=d,console.log("Using selector:",i,"with index:",r),o=!1,document.removeEventListener("mousedown",y,!0),document.removeEventListener("mouseup",y,!0),document.removeEventListener("click",y,!0),console.log("Setting isStrategySettingsDetected to true"),n=!0,console.log("Recreating info window..."),e&&document.body.removeChild(e),a(),chrome.storage.local.set({strategySettingsDetected:!0,strategySettingsSelector:i,strategyButtonIndex:r},(function(){console.log("Settings saved to storage"),b("–ö–Ω–æ–ø–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ —É—Å–ø–µ—à–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞! ‚úÖ")})),!1}}}function b(t){var e=document.createElement("div");e.style.cssText='\n        position: fixed;\n        top: 20px;\n        left: 50%;\n        transform: translateX(-50%);\n        background: #131722;\n        color: #d1d4dc;\n        padding: 10px 20px;\n        border-radius: 4px;\n        z-index: 9999;\n        border: 1px solid #363c4e;\n        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;\n    ',e.textContent=t,document.body.appendChild(e),setTimeout((function(){e.remove()}),3e3)}s=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e;if(u(t),t){var n=t.querySelector(".content");if(n&&(function(){try{var t=document.querySelectorAll(".containerCell-Yvm0jjs7");return t&&0!==t.length?(t.forEach((function(t){var e=t.querySelector(".title-Yvm0jjs7"),n=t.querySelector(".secondRow-Yvm0jjs7");if(e&&n)switch(e.textContent.trim()){case"Net Profit":var o,i,r=null===(o=n.querySelector(".positiveValue-Yvm0jjs7"))||void 0===o||null===(o=o.textContent)||void 0===o?void 0:o.trim(),l=null===(i=n.querySelector(".additionalPercent-Yvm0jjs7"))||void 0===i||null===(i=i.textContent)||void 0===i?void 0:i.trim();d.netProfit=r,d.netProfitPercent=l;break;case"Total Closed Trades":var c,a=null===(c=n.querySelector("div:first-child"))||void 0===c||null===(c=c.textContent)||void 0===c?void 0:c.trim();d.totalTrades=a;break;case"Percent Profitable":var s,u=null===(s=n.querySelector(".positiveValue-Yvm0jjs7"))||void 0===s||null===(s=s.textContent)||void 0===s?void 0:s.trim();d.percentProfitable=u;break;case"Profit Factor":var g,v=null===(g=n.querySelector(".positiveValue-Yvm0jjs7"))||void 0===g||null===(g=g.textContent)||void 0===g?void 0:g.trim();d.profitFactor=v;break;case"Max Drawdown":var m,p,f=null===(m=n.querySelector(".negativeValue-Yvm0jjs7"))||void 0===m||null===(m=m.textContent)||void 0===m?void 0:m.trim(),y=null===(p=n.querySelector(".additionalPercent-Yvm0jjs7"))||void 0===p||null===(p=p.textContent)||void 0===p?void 0:p.trim();d.maxDrawdown=f,d.maxDrawdownPercent=y}})),console.log("–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–∞—Ä—Å–∏–Ω–≥–∞:",d),d):(console.log("–Ø—á–µ–π–∫–∏ —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã"),null)}catch(t){return console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:",t),null}}(),d.netProfit)){var o=document.createElement("div");o.style.fontSize="11px",o.style.opacity="0.8",o.style.marginTop="8px",o.style.borderTop="1px solid #363c4e",o.style.paddingTop="8px";var i=d.netProfit.includes("-")?"#f23645":"#089981";o.innerHTML='\n                    <div style="margin-bottom: 4px; font-weight: bold;">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –±—ç–∫—Ç–µ—Å—Ç–∞:</div>\n                    <div style="color: '.concat(i,'">–ü—Ä–∏–±—ã–ª—å: ').concat(d.netProfit," (").concat(d.netProfitPercent,")</div>\n                    <div>–°–¥–µ–ª–æ–∫: ").concat(d.totalTrades,"</div>\n                    <div>–ü—Ä–∏–±—ã–ª—å–Ω—ã—Ö: ").concat(d.percentProfitable,"</div>\n                    <div>–ü/–§: ").concat(d.profitFactor,'</div>\n                    <div style="color: #f23645">–ü—Ä–æ—Å–∞–¥–∫–∞: ').concat(d.maxDrawdown," (").concat(d.maxDrawdownPercent,")</div>\n                "),n.appendChild(o)}}},chrome.runtime.onMessage.addListener((function(n,o,i){return"GET_TRADING_INFO"===n.type?i(t()):"TOGGLE_INFO_WINDOW"===n.type&&(n.show?e||(e=a()):e&&(l&&(clearInterval(l),l=null),e.remove(),e=null)),!0})),document.addEventListener("DOMContentLoaded",(function(){console.log("DOM loaded, checking settings button"),setTimeout((function(){n||g()}),2e3)})),setInterval((function(){n||g()}),5e3),chrome.storage.local.get(["strategySettingsDetected","strategySettingsSelector","strategyButtonIndex"],(function(t){console.log("Loaded storage:",t),t.strategySettingsDetected&&(n=!0,i=t.strategySettingsSelector,r=t.strategyButtonIndex,console.log("Restored settings selector:",i,"with index:",r))}));var h=new MutationObserver((function(){e&&s()}));function x(){var t=document.querySelector(".backtesting-content");t&&h.observe(t,{childList:!0,subtree:!0,characterData:!0})}document.addEventListener("DOMContentLoaded",(function(){setTimeout(x,2e3)})),setInterval((function(){x()}),5e3)})();
//# sourceMappingURL=content.js.map